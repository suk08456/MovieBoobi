<html layout:decorate="~{layout}">
<div layout:fragment="content">
    <div id="myModal1" class="myModal">
        <div class="modalVideo">
            <div class="closePosition">
                <div class="close" onclick="closeModal('myModal1')">
                    <button class="btn btn-circle" style="margin-left: 1155px;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <iframe width="60%" height="65%"
                    src="https://www.youtube-nocookie.com/embed/NO0QXhgTjHE?si=mNMEVEftNrXoxWqb"
                    title="YouTube video player" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen></iframe>
        </div>
    </div>
    <div id="myModal2" class="myModal">
        <div class="modalVideo">
            <div class="closePosition">
                <div class="close" onclick="closeModal('myModal2')">
                    <button class="btn btn-circle" style="margin-left: 1155px;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <iframe width="60%" height="65%"
                    src="https://www.youtube-nocookie.com/embed/7sAuTASBlu0?si=gkrd6y2csWpP1s9W"
                    title="YouTube video player" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen></iframe>
        </div>
    </div>
    <div id="myModal3" class="myModal">
        <div class="modalVideo">
            <div class="closePosition">
                <div class="close" onclick="closeModal('myModal3')">
                    <button class="btn btn-circle" style="margin-left: 1155px;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <iframe width="60%" height="65%"
                    src="https://www.youtube-nocookie.com/embed/qDE3IJNOyTw?si=FlzxkGzLaMM0vn9n"
                    title="YouTube video player" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen></iframe>
        </div>

    </div>
    <div id="myModal4" class="myModal">
        <div class="modalVideo">
            <div class="closePosition">
                <div class="close" onclick="closeModal('myModal4')">
                    <button class="btn btn-circle" style="margin-left: 1155px;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
            <iframe width="60%" height="65%"
                    src="https://www.youtube-nocookie.com/embed/Hd_zT6I5K6c?si=pQueCtCcpG03Uhfg"
                    title="YouTube video player" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen></iframe>
        </div>
    </div>
    <div class="swiper mySwiper" style="width: 70%; min-width: 1000px;">
        <div class="swiper-wrapper">
            <div class="swiper-slide">
                <div style="display: flex; justify-content: center;">
                    <button class="openModalBtn" data-modal-id="myModal1"
                            style="display: flex; justify-content: center;">
                        <img src="/mainPageImage/movie.jpg" alt="" style="width: 70%">
                    </button>
                </div>
            </div>
            <div class="swiper-slide">
                <div style="display: flex; justify-content: center;">
                    <button class="openModalBtn" data-modal-id="myModal2"
                            style="display: flex; justify-content: center;">
                        <img src="/mainPageImage/drama.jpg" alt="" style="width: 70%">
                    </button>
                </div>
            </div>
            <div class="swiper-slide">
                <div style="display: flex; justify-content: center;">
                    <button class="openModalBtn" data-modal-id="myModal3"
                            style="display: flex; justify-content: center;">
                        <img src="/mainPageImage/book.jpg" alt="" style="width: 70%">
                    </button>
                </div>
            </div>
            <div class="swiper-slide">
                <div style="display: flex; justify-content: center;">
                    <button class="openModalBtn" data-modal-id="myModal4"
                            style="display: flex; justify-content: center;">
                        <img src="/mainPageImage/webtoon.jpg" alt="" style="width: 70%">
                    </button>
                </div>
            </div>
        </div>
        <div class="swiper-pagination"></div>
    </div>
    <div class="swiper mySwiperA" style="width: 70%; min-width: 1000px; margin-top: 3%;">
        <div class="swiper-wrapper">
            <div class="swiper-slide">
                <div style="display: flex; justify-content: center;">
                    <form th:action="@{/movie/detail}" method="get" th:each="movie : ${movieList}" style="display: flex; align-items: center; border: solid 1px; margin: 5px;">
                        <button class="img">
                            <img th:src="${movie.getImageUrl}" style="height: 100%;">
                        </button>
                        <input type="hidden" name="movieCD" th:value="${movie.movieCode}">
                    </form>
                </div>
            </div>
            <div class="swiper-slide">
                <div style="display: flex; justify-content: center;">
                    <form th:action="@{/book/detail}" method="get" th:each="book : ${bookList}" style="display: flex; align-items: center; border: solid 1px; margin: 5px;">
                        <button class="img">
                            <img th:src="${book.getImageUrl}" style="height: 100%;">
                        </button>
                        <input type="hidden" name="isbn" th:value="${book.getIsbn}">
                    </form>
                </div>
            </div>
        </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
    </div>
    <div>
        <button onclick="clickChat()">
            <img class="chatImg" src="/etc/chattingRoom.png" style="position: fixed; bottom: 10px; right: 153px; padding: 10px; width : 78px; z-index : 998;">
        </button>
        <form id="enter-form">
            <label for="username">
                닉네임:
                <input id="username" type="text" required style="background:pink;"  placeholder="사용할 닉네임" >
            </label>
            <button id="enter-button" type="button" onclick="enterChat()" required>채팅하기</button>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
        function clickChat(){
            var enterForm = document.getElementById('enter-form');
            enterForm.style.display = (enterForm.style.display === 'none' || enterForm.style.display === '') ? 'block' : 'none';
        }

        document.getElementById("enter-form").addEventListener("submit", event => {
            event.preventDefault();
            const username = document.getElementById("username").value;
            window.open(`/chat/enter?username=${username}`, "_blank", "width=600,height=400");
        });

        function enterChat() {
            const username = document.getElementById("username").value.trim();
            if (username !== "") {
                const popupUrl = `/chat/enter?username=${encodeURIComponent(username)}`;
                const message = `${username}: 입장하셨습니다.`;
                window.open(popupUrl, "ChatPopup", "width=600,height=500");
            } else {
                alert("닉네임을 입력하세요.");
            }
        }

        document.getElementById("enter-form").addEventListener("submit", event => {
            event.preventDefault();
            enterChat();
        });

        var swiper = new Swiper(".mySwiper", {
            slidesPerView: 1,
            spaceBetween: 30,
            loop: true,
            autoplay: {
            delay: 4000,
            disableOnInteraction: false
        },
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
            },
        });

        var swiper = new Swiper(".mySwiperA", {
            slidesPerView: 1,
            spaceBetween: 30,
            loop: true,
            pagination: {
            el: ".swiper-pagination",
            clickable: true,
            },
            navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
            },
        });

        document.addEventListener('DOMContentLoaded', function() {
            const openModalBtns = document.querySelectorAll('.openModalBtn');

            openModalBtns.forEach(function(btn) {
                btn.addEventListener('click', function() {
                    const modalId = btn.getAttribute('data-modal-id');
                    openModal(modalId);
                });
            });

            window.addEventListener('click', function(event) {
                const modalCloseBtn = event.target.closest('.close');
                if (modalCloseBtn) {
                    const modalId = modalCloseBtn.getAttribute('data-modal-id');
                    closeModal(modalId);
                }
            });
        });

        //  모달 창 열기
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'block';
            document.body.style.overflow = "hidden";
            document.body.style.paddingRight = `${getScrollbarWidth()}px`;
        }

        // 모달 창 닫기
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'none';
            document.body.style.overflow = "auto";
            document.body.style.paddingRight = '0';
        }

        function getScrollbarWidth() {
            const scrollDiv = document.createElement('div');
            scrollDiv.style.width = '100px';
            scrollDiv.style.height = '100px';
            scrollDiv.style.overflow = 'scroll';
            scrollDiv.style.position = 'absolute';
            scrollDiv.style.top = '-9999px';
            document.body.appendChild(scrollDiv);
            const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;
            document.body.removeChild(scrollDiv);
            return scrollbarWidth;
        }
    </script>
</div>
</html>